# 铁血攻城 (IronBlood Siege) 🏰

<div align="center">
  <img src="https://img.shields.io/badge/游戏-骑马与砍杀：霸主-red"/>
  <img src="https://img.shields.io/badge/游戏版本-1.2.12-blue"/>
  <img src="https://img.shields.io/badge/语言-中文%20%7C%20English-green"/>
  
  简体中文 | [English](README_EN.md)
</div>

## 简介
铁血攻城是一个《骑马与砍杀2：霸主》(Mount & Blade II: Bannerlord) 的mod，旨在增强攻城战的体验。原版攻守城战斗中，攻城士兵动不动无脑逃跑，经常出现人数碾压守军仍然溃败，导致对于深度高难度玩家的战斗体验较差 ，本mod可有效防止攻城士兵无脑逃跑，并动态调用函数调整士气值，确保攻城持续性。
- 1.2+版本以上攻城的攻城方机制是士气结合战斗指挥系统而控制，其他包括防止溃军的mod在攻城战中大多数无法生效，所以本mod结合战斗指挥系统，动态调用函数调整士气值，士气值的调整是一个基本参考。

- 本人仅测试了1.2.12版本，基本上没有什么问题，其他版本未测试。

## 功能
- 防止攻城士兵动不动逃跑
- 动态调用函数调整士气值，确保攻城持续性
- 完全可配置的设置选项
- 实时战场状态反馈

## 主要特性
### 铁血进攻机制
- 在攻城战中阻止士兵随意撤退
- 根据战场形势动态调整士气
- 当士兵数量不足时会自动解除铁血状态
- 支持两种撤退判定方式：
  - 固定数量模式：当进攻方士兵低于指定数量时解除铁血
  - 比例模式：当进攻方士兵数量低于守军70%时解除铁血
- 如果在倒计时期间有援军到达，会自动恢复铁血状态
- 低于设置士兵数量阈值且无援兵解除铁血状态

### 士气调整
- 实时监控并提升低士气单位
- 当士兵士气低于设定阈值时进行提升
- 使用可配置的提升速率
- 会显示被鼓舞的士兵数量

## 计算战场优势比率
- 使用公式：strengthRatio = attackerCount / defenderCount
- 如果防守方人数为0，则默认设置为2.0（表示极大优势）
- 这个比率反映了攻守双方的数量对比

## 动态调整士气阈值
- 当攻方数量优势明显时(比率 >= 1.5)，会降低士气阈值
- 具体做法是将原始阈值乘以0.6
- 优势情况下，系统对士气的要求会更宽松

## 战场信息反馈
- 战场状态变化
- 关键信息提示：
  - 士兵被鼓舞的数量
  - 援军到达的通知
  - 撤退条件触发的提示
- 支持多语言本地化，目前有中文和英文

## 配置选项
- 可在游戏内设置面板中调整：
  - 启用/禁用整个模组
  - 选择撤退判定方式（固定数量/比例）
  - 设置固定数量模式的阈值
  - 调整士气提升阈值
  - 设置士气提升速率

## 注意事项
- 两种撤退判定方式只能选择其一
- 建议根据战场规模选择合适的固定数量阈值
- 比例模式目前设置为 70％
- Debug版本输出详细日志

## 安装要求
- 游戏版本：Mount & Blade II: Bannerlord 1.2.12
- MCM (Mod Configuration Menu) v5+

## 安装方法
1. 确保已安装MCM (Mod Configuration Menu)
2. 将mod文件复制到游戏的Modules文件夹中
3. 启动启动器，在Mods选项中启用"铁血攻城"
4. 确保加载顺序中MCM在本mod之前

## 设置说明
在游戏中可通过MCM菜单调整以下设置：

### 基础设置
- 启用Mod：开启/关闭mod功能

### 战斗设置
- 攻城士兵士气阈值 (20-80)：
  - 当士兵士气低于此值时会被提升
  - 默认值：70
  - 建议：优势时设置较低，劣势时设置较高

- 士气提升速率 (5-30)：
  - 每次提升士气的幅度
  - 默认值：15
  - 建议：根据战况调整，通常15-20较为合适

## 使用提示
- 在攻城战开始时，mod会自动生效
- 可以在战斗中随时通过ESC菜单调整设置
- 多mod中，建议本mod在最后加载


## 联系方式
- 作者：Ahao
- 邮箱：2285813721@qq.com,ahao221x@gmail.com

## 许可
本mod仅供个人使用，禁止用于商业用途。